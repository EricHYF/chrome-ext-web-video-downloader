<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è§†é¢‘ä¸‹è½½å™¨æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .section {
            margin: 40px 0;
            padding: 20px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            background: #f8fafc;
        }
        .section h2 {
            color: #1e293b;
            margin-bottom: 16px;
        }
        .test-video {
            margin: 20px 0;
            padding: 16px;
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            background: white;
        }
        .test-video h3 {
            color: #475569;
            margin-bottom: 12px;
        }
        video {
            width: 100%;
            max-width: 500px;
            height: auto;
        }
        .video-info {
            margin-top: 12px;
            padding: 8px;
            background: #f1f5f9;
            border-radius: 4px;
            font-size: 14px;
            color: #64748b;
        }
        .test-button {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 8px 4px;
            font-size: 14px;
        }
        .test-button:hover {
            background: #4338ca;
        }
        .test-result {
            margin-top: 12px;
            padding: 8px;
            border-radius: 4px;
            font-size: 14px;
            display: none;
        }
        .test-result.success {
            background: #dcfce7;
            color: #166534;
            border: 1px solid #bbf7d0;
        }
        .test-result.error {
            background: #fef2f2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }
        .instructions {
            background: #dbeafe;
            border: 1px solid #93c5fd;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .instructions h3 {
            color: #1d4ed8;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <header>
        <h1>ğŸ¬ è§†é¢‘ä¸‹è½½å™¨æ‰©å±•æµ‹è¯•é¡µé¢</h1>
        <div class="instructions">
            <h3>æµ‹è¯•è¯´æ˜ï¼š</h3>
            <ol>
                <li>ç¡®ä¿å·²å®‰è£…è§†é¢‘ä¸‹è½½å™¨Chromeæ‰©å±•</li>
                <li>åˆ·æ–°æ­¤é¡µé¢ï¼Œç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½</li>
                <li>ç‚¹å‡»æµè§ˆå™¨å·¥å…·æ ä¸­çš„æ‰©å±•å›¾æ ‡</li>
                <li>æŸ¥çœ‹æ‰©å±•æ˜¯å¦æ£€æµ‹åˆ°é¡µé¢ä¸­çš„è§†é¢‘</li>
                <li>æµ‹è¯•å„ç§ä¸‹è½½åŠŸèƒ½</li>
            </ol>
        </div>
    </header>

    <main>
        <!-- HTML5 Video æµ‹è¯• -->
        <section class="section">
            <h2>ğŸ“¹ HTML5 è§†é¢‘æµ‹è¯•</h2>
            
            <div class="test-video">
                <h3>æ ‡å‡†MP4è§†é¢‘</h3>
                <video controls poster="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iNTAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iIzRmNDZlNSIvPgogIDx0ZXh0IHg9IjI1MCIgeT0iMTUwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSJ3aGl0ZSIgZm9udC1zaXplPSIyNCIgZm9udC1mYW1pbHk9IkFyaWFsIj7mu4DlrZfop4bpopE8L3RleHQ+Cjwvc3ZnPg==">
                    <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
                    <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.webm" type="video/webm">
                    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚
                </video>
                <div class="video-info">
                    <strong>è§†é¢‘æºï¼š</strong> BigBuckBunny.mp4 (æ ·ä¾‹è§†é¢‘)<br>
                    <strong>æ ¼å¼ï¼š</strong> MP4/WebM<br>
                    <strong>æœŸæœ›ç»“æœï¼š</strong> æ‰©å±•åº”è¯¥æ£€æµ‹åˆ°è¿™ä¸ªè§†é¢‘å¹¶æ˜¾ç¤ºä¸‹è½½é€‰é¡¹
                </div>
                <button class="test-button" onclick="testVideoDetection('html5-mp4')">æµ‹è¯•æ£€æµ‹</button>
                <div id="result-html5-mp4" class="test-result"></div>
            </div>

            <div class="test-video">
                <h3>å¤šæºè§†é¢‘</h3>
                <video controls id="multi-source-video">
                    <source src="https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4" type="video/mp4">
                    <source src="https://sample-videos.com/zip/10/webm/SampleVideo_1280x720_1mb.webm" type="video/webm">
                    <source src="https://sample-videos.com/zip/10/avi/SampleVideo_1280x720_1mb.avi" type="video/avi">
                </video>
                <div class="video-info">
                    <strong>å¤šæ ¼å¼æºï¼š</strong> MP4, WebM, AVI<br>
                    <strong>æœŸæœ›ç»“æœï¼š</strong> æ‰©å±•åº”è¯¥æ£€æµ‹åˆ°å¤šä¸ªè§†é¢‘æº
                </div>
                <button class="test-button" onclick="testVideoDetection('multi-source')">æµ‹è¯•æ£€æµ‹</button>
                <div id="result-multi-source" class="test-result"></div>
            </div>
        </section>

        <!-- åµŒå…¥å¼è§†é¢‘æµ‹è¯• -->
        <section class="section">
            <h2>ğŸ­ åµŒå…¥å¼è§†é¢‘æµ‹è¯•</h2>
            
            <div class="test-video">
                <h3>iframeåµŒå…¥è§†é¢‘</h3>
                <iframe width="500" height="300" 
                        src="https://www.youtube.com/embed/dQw4w9WgXcQ" 
                        frameborder="0" 
                        allowfullscreen>
                </iframe>
                <div class="video-info">
                    <strong>ç±»å‹ï¼š</strong> YouTubeåµŒå…¥è§†é¢‘<br>
                    <strong>æœŸæœ›ç»“æœï¼š</strong> æ‰©å±•å¯èƒ½æ£€æµ‹åˆ°iframeä¸­çš„è§†é¢‘èµ„æº
                </div>
                <button class="test-button" onclick="testVideoDetection('iframe')">æµ‹è¯•æ£€æµ‹</button>
                <div id="result-iframe" class="test-result"></div>
            </div>

            <div class="test-video">
                <h3>è‡ªå®šä¹‰æ’­æ”¾å™¨</h3>
                <div class="video-player-container" 
                     data-video-url="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4"
                     data-title="å¤§è±¡ä¹‹æ¢¦">
                    <div style="width: 500px; height: 300px; background: #000; display: flex; align-items: center; justify-content: center; color: white; border-radius: 8px;">
                        <div style="text-align: center;">
                            <div style="font-size: 48px; margin-bottom: 16px;">â–¶ï¸</div>
                            <div>è‡ªå®šä¹‰è§†é¢‘æ’­æ”¾å™¨</div>
                            <div style="font-size: 14px; opacity: 0.7;">ç‚¹å‡»æ’­æ”¾è§†é¢‘</div>
                        </div>
                    </div>
                </div>
                <div class="video-info">
                    <strong>æ•°æ®å±æ€§ï¼š</strong> data-video-url<br>
                    <strong>æœŸæœ›ç»“æœï¼š</strong> æ‰©å±•åº”è¯¥æ£€æµ‹åˆ°dataå±æ€§ä¸­çš„è§†é¢‘URL
                </div>
                <button class="test-button" onclick="testVideoDetection('custom-player')">æµ‹è¯•æ£€æµ‹</button>
                <div id="result-custom-player" class="test-result"></div>
            </div>
        </section>

        <!-- åŠ¨æ€åŠ è½½æµ‹è¯• -->
        <section class="section">
            <h2>âš¡ åŠ¨æ€åŠ è½½æµ‹è¯•</h2>
            
            <div class="test-video">
                <h3>JavaScriptåŠ¨æ€åˆ›å»ºè§†é¢‘</h3>
                <div id="dynamic-video-container"></div>
                <div class="video-info">
                    <strong>åŠ è½½æ–¹å¼ï¼š</strong> JavaScriptåŠ¨æ€åˆ›å»ºvideoå…ƒç´ <br>
                    <strong>æœŸæœ›ç»“æœï¼š</strong> æ‰©å±•åº”è¯¥æ£€æµ‹åˆ°åŠ¨æ€æ·»åŠ çš„è§†é¢‘
                </div>
                <button class="test-button" onclick="loadDynamicVideo()">åŠ è½½åŠ¨æ€è§†é¢‘</button>
                <button class="test-button" onclick="testVideoDetection('dynamic')">æµ‹è¯•æ£€æµ‹</button>
                <div id="result-dynamic" class="test-result"></div>
            </div>

            <div class="test-video">
                <h3>AJAXè¯·æ±‚æ¨¡æ‹Ÿ</h3>
                <div class="video-info">
                    <strong>æ¨¡æ‹Ÿåœºæ™¯ï¼š</strong> æ¨¡æ‹ŸAJAXè¯·æ±‚è·å–è§†é¢‘URL<br>
                    <strong>æœŸæœ›ç»“æœï¼š</strong> æ‰©å±•åº”è¯¥æ‹¦æˆªåˆ°è§†é¢‘ç›¸å…³çš„ç½‘ç»œè¯·æ±‚
                </div>
                <button class="test-button" onclick="simulateAjaxRequest()">æ¨¡æ‹ŸAJAXè¯·æ±‚</button>
                <button class="test-button" onclick="testVideoDetection('ajax')">æµ‹è¯•æ£€æµ‹</button>
                <div id="result-ajax" class="test-result"></div>
            </div>
        </section>

        <!-- HLSæµæµ‹è¯• -->
        <section class="section">
            <h2>ğŸ“¡ HLSæµåª’ä½“æµ‹è¯•</h2>
            
            <div class="test-video">
                <h3>æ¨¡æ‹ŸHLSæµ</h3>
                <div class="video-info">
                    <strong>æ³¨æ„ï¼š</strong> è¿™æ˜¯æ¨¡æ‹Ÿçš„HLSæµURLï¼Œç”¨äºæµ‹è¯•æ£€æµ‹åŠŸèƒ½<br>
                    <strong>æœŸæœ›ç»“æœï¼š</strong> æ‰©å±•åº”è¯¥è¯†åˆ«.m3u8æ ¼å¼å¹¶æä¾›HLSä¸‹è½½é€‰é¡¹
                </div>
                <button class="test-button" onclick="simulateHLSRequest()">æ¨¡æ‹ŸHLSè¯·æ±‚</button>
                <button class="test-button" onclick="testVideoDetection('hls')">æµ‹è¯•æ£€æµ‹</button>
                <div id="result-hls" class="test-result"></div>
            </div>
        </section>

        <!-- æµ‹è¯•ç»“æœæ±‡æ€» -->
        <section class="section">
            <h2>ğŸ“Š æµ‹è¯•ç»“æœæ±‡æ€»</h2>
            <div id="test-summary">
                <p>ç‚¹å‡»å„éƒ¨åˆ†çš„"æµ‹è¯•æ£€æµ‹"æŒ‰é’®æ¥éªŒè¯æ‰©å±•åŠŸèƒ½ã€‚</p>
                <p>æµ‹è¯•å®Œæˆåï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºæ±‡æ€»ç»“æœã€‚</p>
            </div>
        </section>
    </main>

    <script>
        // æµ‹è¯•è¾…åŠ©å‡½æ•°
        let testResults = {};

        function testVideoDetection(testType) {
            const resultDiv = document.getElementById(`result-${testType}`);
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result success';
            resultDiv.innerHTML = 'âœ… è¯·æ£€æŸ¥æ‰©å±•å¼¹çª—æ˜¯å¦æ£€æµ‹åˆ°æ­¤è§†é¢‘';
            
            testResults[testType] = 'tested';
            updateTestSummary();
        }

        function loadDynamicVideo() {
            const container = document.getElementById('dynamic-video-container');
            container.innerHTML = `
                <video controls style="width: 100%; max-width: 500px;">
                    <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4" type="video/mp4">
                    åŠ¨æ€åŠ è½½çš„è§†é¢‘
                </video>
            `;
            
            // æ¨¡æ‹Ÿè§†é¢‘åŠ è½½äº‹ä»¶
            const video = container.querySelector('video');
            video.addEventListener('loadstart', function() {
                console.log('åŠ¨æ€è§†é¢‘å¼€å§‹åŠ è½½:', video.src);
            });
        }

        function simulateAjaxRequest() {
            // æ¨¡æ‹ŸAJAXè¯·æ±‚è§†é¢‘èµ„æº
            const videoUrls = [
                'https://example.com/video1.mp4',
                'https://example.com/stream/video.m3u8',
                'https://example.com/media/video.webm'
            ];

            videoUrls.forEach(url => {
                // æ¨¡æ‹Ÿfetchè¯·æ±‚
                console.log('æ¨¡æ‹Ÿè¯·æ±‚:', url);
                
                // åˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿçš„ç½‘ç»œè¯·æ±‚
                if (window.fetch) {
                    fetch(url).catch(e => {
                        console.log('æ¨¡æ‹Ÿè¯·æ±‚å®Œæˆï¼ˆé¢„æœŸå¤±è´¥ï¼‰:', url);
                    });
                }
            });

            const resultDiv = document.getElementById('result-ajax');
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result success';
            resultDiv.innerHTML = 'âœ… å·²å‘é€æ¨¡æ‹Ÿè¯·æ±‚ï¼Œæ£€æŸ¥æ§åˆ¶å°å’Œæ‰©å±•æ£€æµ‹ç»“æœ';
        }

        function simulateHLSRequest() {
            // æ¨¡æ‹ŸHLSæ’­æ”¾åˆ—è¡¨è¯·æ±‚
            const hlsUrl = 'https://example.com/stream/playlist.m3u8';
            
            console.log('æ¨¡æ‹ŸHLSè¯·æ±‚:', hlsUrl);
            
            // æ¨¡æ‹ŸXMLHttpRequest
            const xhr = new XMLHttpRequest();
            xhr.open('GET', hlsUrl, true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    console.log('HLSè¯·æ±‚å®Œæˆï¼ˆæ¨¡æ‹Ÿï¼‰');
                }
            };
            
            try {
                xhr.send();
            } catch (e) {
                console.log('HLSæ¨¡æ‹Ÿè¯·æ±‚å‘é€å®Œæˆ');
            }

            const resultDiv = document.getElementById('result-hls');
            resultDiv.style.display = 'block';
            resultDiv.className = 'test-result success';
            resultDiv.innerHTML = 'âœ… å·²æ¨¡æ‹ŸHLSè¯·æ±‚ï¼Œæ£€æŸ¥æ‰©å±•æ˜¯å¦æ£€æµ‹åˆ°.m3u8æ ¼å¼';
        }

        function updateTestSummary() {
            const summary = document.getElementById('test-summary');
            const totalTests = Object.keys(testResults).length;
            const testedCount = Object.values(testResults).filter(r => r === 'tested').length;
            
            summary.innerHTML = `
                <h3>æµ‹è¯•è¿›åº¦ï¼š${testedCount}/${totalTests}</h3>
                <p><strong>å·²æµ‹è¯•çš„åŠŸèƒ½ï¼š</strong></p>
                <ul>
                    ${Object.keys(testResults).map(test => 
                        `<li>${test}: ${testResults[test] === 'tested' ? 'âœ… å·²æµ‹è¯•' : 'â³ å¾…æµ‹è¯•'}</li>`
                    ).join('')}
                </ul>
                <div style="margin-top: 16px; padding: 12px; background: #fef3c7; border: 1px solid #f59e0b; border-radius: 6px;">
                    <strong>ğŸ“‹ æµ‹è¯•æ¸…å•ï¼š</strong>
                    <ul style="margin: 8px 0;">
                        <li>æ‰©å±•å›¾æ ‡æ˜¯å¦å‡ºç°åœ¨å·¥å…·æ </li>
                        <li>ç‚¹å‡»æ‰©å±•å›¾æ ‡æ˜¯å¦æ˜¾ç¤ºå¼¹çª—</li>
                        <li>å¼¹çª—ä¸­æ˜¯å¦åˆ—å‡ºæ£€æµ‹åˆ°çš„è§†é¢‘</li>
                        <li>è§†é¢‘ä¿¡æ¯æ˜¯å¦æ­£ç¡®æ˜¾ç¤ºï¼ˆæ ‡é¢˜ã€æ ¼å¼ç­‰ï¼‰</li>
                        <li>ä¸‹è½½æŒ‰é’®æ˜¯å¦å¯ä»¥ç‚¹å‡»</li>
                        <li>ä¸‹è½½åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œ</li>
                    </ul>
                </div>
            `;
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('è§†é¢‘ä¸‹è½½å™¨æµ‹è¯•é¡µé¢å·²åŠ è½½');
            console.log('è¯·ç¡®ä¿å·²å®‰è£…è§†é¢‘ä¸‹è½½å™¨æ‰©å±•ï¼Œç„¶åç‚¹å‡»æ‰©å±•å›¾æ ‡è¿›è¡Œæµ‹è¯•');
            
            // æ·»åŠ ä¸€äº›æµ‹è¯•ç”¨çš„è§†é¢‘URLåˆ°é¡µé¢æ•°æ®ä¸­
            window.testVideoUrls = [
                'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4',
                'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',
                'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4'
            ];
        });

        // ç›‘å¬æ‰©å±•æ¶ˆæ¯ï¼ˆå¦‚æœæ‰©å±•å°è¯•ä¸é¡µé¢é€šä¿¡ï¼‰
        window.addEventListener('message', function(event) {
            if (event.data.type === 'VIDEO_DETECTED_INJECTED') {
                console.log('æ£€æµ‹åˆ°æ‰©å±•å‘ç°çš„è§†é¢‘:', event.data);
            }
        });
    </script>
</body>
</html>